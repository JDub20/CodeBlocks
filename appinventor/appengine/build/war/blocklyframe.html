<!-- Copyright 2012 Massachusetts Institute of Technology. All Rights Reserved. -->

<!-- The contents of a blocks editor iframe in App Inventor -->
<html>
  <head>
    <script type="text/javascript" src="closure-library-20120710-r2029/closure/goog/base.js"></script>
    <link type="text/css" rel="stylesheet" href="media/blockly.css">
    <link type="text/css" rel="stylesheet" href="closure-library-20120710-r2029/closure/goog/css/dialog.css">
    <script type="text/javascript" src="blockly-all.js"></script>
    <style>
      html, body {
      background-color: #fff;
      margin: 0;
      padding:0;
      overflow: hidden;
    }
    .blocklySvg {
      height: 100%;
      width: 100%;
    }
    </style>

    <script type="text/javascript">
      function init() {
        // We expect window.location.hash to have the form:
        // projectId_formName, and to be unique among
        // all the Blockly instances created in this App Inventor session.
        if (Blockly['ReplState'] == undefined)
            Blockly.ReplState = new Blockly.ReplStateObj();
        var formName = window.location.hash.substr(1);
        Blockly.BlocklyEditor.startup(document.body, formName);
        if (!window.parent.Blocklies) {
          // We keep a set of Blockly objects indexed by name
          // of the form for which they are the blocks editor
          window.parent.Blocklies = {};
          window.parent.ReplState = new Blockly.ReplStateObj(); // There should be one of these for the whole system
        }
        window.parent.Blocklies[formName] = Blockly;
        window.parent.Blocklies[formName].ReplState = window.parent.ReplState;
        window.parent.BlocklyPanel_initBlocksArea(formName);
      }
    </script>
  </head>
<body onload="init()">  </body>
</html>
